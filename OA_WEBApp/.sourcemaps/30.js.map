{"version":3,"sources":["../../src/pages/account/account.module.ts","../../src/model/UserInfo.ts","../../src/pages/account/account.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAyC;AACO;AACZ;AAapC;IAAA;IAA6B,CAAC;IAAjB,aAAa;QAXzB,uEAAQ,CAAC;YACN,YAAY,EAAE;gBACV,yDAAO;aACV;YACD,OAAO,EAAE;gBACL,sEAAe,CAAC,QAAQ,CAAC,yDAAO,CAAC;aACpC;YACD,OAAO,EAAE;gBACL,yDAAO;aACV;SACJ,CAAC;OACW,aAAa,CAAI;IAAD,oBAAC;CAAA;AAAJ;;;;;;;;;ACf1B;AAAA;IAAA;IA8CA,CAAC;IAAD,eAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9CyC;AAC+D;AAChE;AAEzC,sEAAsE;AACtE,8FAA8F;AAC9F,4DAA4D;AAGZ;AACQ;AACxD,8CAA8C;AAEgB;AAEJ;AAEC;AACb;AAI9C;;;;;GAKG;AAOH;IAMI,iBAAmB,OAAsB,EACtB,SAAoB,EACnB,OAAgB,EAChB,UAAsB,EACtB,MAAc,EACd,SAA0B,EAC1B,eAAsC,EACtC,WAAwB,EACzB,aAA4B;QAR/C,iBA0BC;QA1BkB,YAAO,GAAP,OAAO,CAAe;QACtB,cAAS,GAAT,SAAS,CAAW;QACnB,YAAO,GAAP,OAAO,CAAS;QAChB,eAAU,GAAV,UAAU,CAAY;QACtB,WAAM,GAAN,MAAM,CAAQ;QACd,cAAS,GAAT,SAAS,CAAiB;QAC1B,oBAAe,GAAf,eAAe,CAAuB;QACtC,gBAAW,GAAX,WAAW,CAAa;QACzB,kBAAa,GAAb,aAAa,CAAe;QAb/C,aAAQ,GAAa,IAAI,iEAAQ,EAAE,CAAC;QACpC,aAAQ,GAAY,KAAK,CAAC,CAAC,WAAW;QAalC,IAAI,CAAC,QAAQ,CAAC,KAAK,GAAG,sBAAsB,CAAC;QAC7C,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,UAAC,QAAkB;YACjD,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACX,QAAQ,CAAC,KAAK,GAAG,QAAQ,CAAC,KAAK,GAAG,QAAQ,CAAC,KAAK,GAAG,KAAI,CAAC,QAAQ,CAAC,KAAK,CAAC;gBACvE,KAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;gBACzB,KAAI,CAAC,MAAM,CAAC,OAAO,CAAC,YAAY,EAAE,QAAQ,CAAC,CAAC;gBAC5C,KAAI,CAAC,UAAU,CAAC,GAAG,GAAG,QAAQ,CAAC,GAAG,CAAC;gBACnC,KAAI,CAAC,UAAU,CAAC,IAAI,GAAG,QAAQ,CAAC,IAAI,CAAC;gBACrC,0CAA0C;YAC9C,CAAC;YAAC,IAAI,CAAC,CAAC;gBACJ,IAAI,KAAK,GAAG,KAAI,CAAC,SAAS,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;gBAC/C,KAAK,CAAC,OAAO,EAAE,CAAC;gBAChB,KAAK,CAAC,YAAY,CAAC,cAAI;oBACnB,IAAI,IAAI,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;gBAC9B,CAAC,CAAC,CAAC;YACP,CAAC;QACL,CAAC,CAAC,CAAC;IACP,CAAC;IAED,gCAAc,GAAd;QACI,OAAO,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC;IAC1C,CAAC;IAED,sBAAI,GAAJ;QACI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;IACrC,CAAC;IAED,4BAAU,GAAV;QACI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;IACrC,CAAC;IAED,yBAAO,GAAP;QACI,0CAA0C;QAC1C,IAAI,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,qBAAqB,CAAC,CAAC;QACzD,KAAK,CAAC,OAAO,EAAE,CAAC;IACpB,CAAC;IAED,6BAAW,GAAX;QAAA,iBAgCC;QA/BG,IAAI,OAAO,GAAG;YACV,WAAW,EAAE,GAAG;YAChB,YAAY,EAAE,GAAG;SACpB,CAAC;QACF,IAAI,WAAW,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;YAC1C,KAAK,EAAE,MAAM;YACb,OAAO,EAAE;gBACL;oBACI,IAAI,EAAE,SAAS;oBACf,OAAO,EAAE;wBACL,KAAI,CAAC,aAAa,CAAC,wBAAwB,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC,qBAAW;4BACtE,KAAI,CAAC,iBAAiB,CAAC,WAAW,CAAC,CAAC;wBACxC,CAAC,CAAC,CAAC;oBACP,CAAC;iBACJ,EAAE;oBACC,IAAI,EAAE,IAAI;oBACV,OAAO,EAAE;wBACL,KAAI,CAAC,aAAa,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC,qBAAW;4BAChE,KAAI,CAAC,iBAAiB,CAAC,WAAW,CAAC,CAAC;wBACxC,CAAC,CAAC,CAAC;oBACP,CAAC;iBACJ,EAAE;oBACC,IAAI,EAAE,IAAI;oBACV,IAAI,EAAE,QAAQ;oBACd,OAAO,EAAE;wBACL,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;oBACxB,CAAC;iBACJ;aACJ;SACJ,CAAC,CAAC;QACH,WAAW,CAAC,OAAO,EAAE,CAAC;IAC1B,CAAC;IAEO,mCAAiB,GAAzB,UAA0B,WAAW;QACjC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;QACrB,IAAI,CAAC,WAAW,GAAW,WAAW,CAAC;QACvC,IAAI,CAAC,QAAQ,CAAC,KAAK,GAAG,wBAAwB,GAAG,WAAW,CAAC;IACjE,CAAC;IAED,sBAAI,GAAJ;QAAA,iBAiBC;QAhBG,EAAE,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;YAChB,IAAI,OAAO,GAAY,EAAE,QAAQ,EAAE,IAAI,CAAC,WAAW,EAAE,CAAC;YACtD,IAAI,CAAC,WAAW,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC,gBAAM;gBACrD,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;oBACT,IAAI,UAAQ,GAAG,4EAAc,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC;oBACnD,KAAI,CAAC,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,UAAC,QAAkB;wBACjD,QAAQ,CAAC,KAAK,GAAG,UAAQ,CAAC;wBAC1B,KAAI,CAAC,OAAO,CAAC,GAAG,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;oBAC3C,CAAC,CAAC,CAAC;oBACH,iDAAiD;oBACjD,qBAAqB;gBACzB,CAAC;YACL,CAAC,CAAC,CAAC;QACP,CAAC;QAAC,IAAI,CAAC,CAAC;YACJ,IAAI,CAAC,QAAQ,CAAC,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,CAAC;QAChE,CAAC;IACL,CAAC;IAED,yBAAO,GAAP;QACI,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC,CAAC,OAAO;QAC7B,+DAAK,CAAC,mBAAmB,EAAE,CAAC,CAAC,SAAS;QACtC,IAAI,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;QAC/C,KAAK,CAAC,OAAO,EAAE,CAAC;QAChB,KAAK,CAAC,YAAY,CAAC,cAAI;YACnB,IAAI,IAAI,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QAC9B,CAAC,CAAC,CAAC;IACP,CAAC;IAvHQ,OAAO;QALnB,wEAAS,CAAC;YACP,QAAQ,EAAE,cAAc;WACG;SAC9B,CAAC;6EAQ2C;YACX,gEAAS;YACV,yEAAO;YACJ,8DAAU;YACd,sEAAM;YACH,4EAAe;YACT,4EAAqB;YACzB,+EAAW;YACV,IAAa;OAdtC,OAAO,CAyHnB;IAAD,CAAC;AAAA;SAzHY,OAAO,mB","file":"30.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { Account } from './account';\n\n@NgModule({\n    declarations: [\n        Account,\n    ],\n    imports: [\n        IonicPageModule.forChild(Account),\n    ],\n    exports: [\n        Account,\n    ]\n})\nexport class AccountModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/account/account.module.ts","export class UserInfo {\n    Uid: string; // 用户id\n    Pwd: string; // 用户密码\n    Name: string; // 用户名称\n    Company: string; // 公司所属\n    Dept: string; // 部门\n    Duty: string; // 职责\n    InDate: string; // 入职日期\n    Sex: string; // 性别\n    BirthDate: string; // 生日\n    Mobile: string; // 移动电话\n    Status: string; // 账号状态\n    SDate: string; // 账号有效期-开始时间\n    EDate: string; // 账号有效期-结束时间\n    UserTp: string; // 用户类型\n    InlinePhone: string; // 内部电话\n    Mail: string; // 邮箱\n    WorkPhone: string; // 办公电话\n    RoleName: string; // 角色名称\n    Token: string; // 角色权限\n    RoleAuthority: string; // 角色权限\n    photo: string; // 照片暂无\n    \n    // cjr: string; // 创建人\n    // Cjsj: string; // 创建时间\n    // lasttime: string; // 上次登录时间\n    // ui_bgdh: string; // 办公电话\n    // ui_comm: string; // 备注\n    // ui_csrq: string; // --出生日期\n    // ui_czdh: string; // --内线电话\n    // ui_desc: string; // --用户姓名\n    // ui_edate: string; // 有效结束日期\n    // ui_id: string; // 编号\n    // ui_lx: string; // --用户类型\n    // ui_mail: string; // 邮箱\n    // ui_pwd: string; // 密码\n    // ui_role: string; // 角色\n    // ui_rzrq: string; // 入职日期\n    // ui_sdate: string; // 有效开始日期\n    // ui_sex: string; // 性别\n    // ui_ssbm: string; // 部门\n    // ui_ssgs: string; // -所属子公司\n    // ui_status: string; // 用户状态\n    // ui_yddx: string; // 移动电话\n    // ui_zw: string; // 职务\n    // photo: string; // 照片暂无\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/model/UserInfo.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, Events, ModalController, ActionSheetController } from 'ionic-angular';\r\nimport { Storage } from '@ionic/storage';\r\n\r\n// import { AccountEdit } from '../account/account-edit/account-edit';\r\n// import { AccountPasswordedit } from '../account/account-passwordedit/account-passwordedit';\r\n// import { AboutusPage } from '../account/aboutus/aboutus';\r\n\r\n\r\nimport { UserInfo } from \"../../model/UserInfo\";\r\nimport { GlobalData } from \"../../providers/GlobalData\";\r\n// import { LoginPage } from \"../login/login\";\r\n\r\nimport { NativeService } from '../../providers/NativeService';\r\n\r\nimport { FileService } from \"../../providers/FileService\";\r\nimport { FileObj } from \"../../model/FileObj\";\r\nimport { FILE_SERVE_URL } from \"../../providers/Constants\";\r\nimport { Utils } from \"../../providers/Utils\";\r\n\r\n\r\n\r\n/**\r\n * Generated class for the Account page.\r\n *\r\n * See http://ionicframework.com/docs/components/#navigation for more info\r\n * on Ionic pages and navigation.\r\n */\r\n@IonicPage()\r\n@Component({\r\n    selector: 'page-account',\r\n    templateUrl: 'account.html',\r\n})\r\n\r\nexport class Account {\r\n    userInfo: UserInfo = new UserInfo();\r\n    isChange: boolean = false; // 头像是否改变标识\r\n    // avatarPath: string;\r\n    imageBase64: string;\r\n\r\n    constructor(public navCtrl: NavController,\r\n                public navParams: NavParams,\r\n                private storage: Storage,\r\n                private globalData: GlobalData,\r\n                private events: Events,\r\n                private modalCtrl: ModalController,\r\n                private actionSheetCtrl: ActionSheetController,\r\n                private fileService: FileService,\r\n                public nativeService: NativeService) {\r\n        this.userInfo.photo = \"assets/img/ionic.png\";\r\n        this.storage.get('UserInfo').then((userInfo: UserInfo) => {\r\n            if (userInfo) {\r\n                userInfo.photo = userInfo.photo ? userInfo.photo : this.userInfo.photo;\r\n                this.userInfo = userInfo;\r\n                this.events.publish('user:login', userInfo);\r\n                this.globalData.Uid = userInfo.Uid;\r\n                this.globalData.Name = userInfo.Name;\r\n                // this.globalData.token = userInfo.token;\r\n            } else {\r\n                let modal = this.modalCtrl.create(\"LoginPage\");\r\n                modal.present();\r\n                modal.onDidDismiss(data => {\r\n                    data && console.log(data);\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    ionViewDidLoad() {\r\n        console.log('ionViewDidLoad Account');\r\n    }\r\n\r\n    edit() {\r\n        this.navCtrl.push(\"AccountEdit\");\r\n    }\r\n\r\n    getAboutus() {\r\n        this.navCtrl.push(\"AboutusPage\");\r\n    }\r\n\r\n    pwdEdit() {\r\n        // this.navCtrl.push(AccountPasswordedit);\r\n        let modal = this.modalCtrl.create(\"AccountPasswordedit\");\r\n        modal.present();\r\n    }\r\n\r\n    changePhoto() {\r\n        let options = {\r\n            targetWidth: 400,\r\n            targetHeight: 400\r\n        };\r\n        let actionSheet = this.actionSheetCtrl.create({\r\n            title: '修改头像',\r\n            buttons: [\r\n                {\r\n                    text: '从相册选择图片',\r\n                    handler: () => {\r\n                        this.nativeService.getPictureByPhotoLibrary(options).subscribe(imageBase64 => {\r\n                            this.getPictureSuccess(imageBase64);\r\n                        });\r\n                    }\r\n                }, {\r\n                    text: '拍照',\r\n                    handler: () => {\r\n                        this.nativeService.getPictureByCamera(options).subscribe(imageBase64 => {\r\n                            this.getPictureSuccess(imageBase64);\r\n                        });\r\n                    }\r\n                }, {\r\n                    text: '取消',\r\n                    role: 'cancel',\r\n                    handler: () => {\r\n                        console.log('取消修改');\r\n                    }\r\n                }\r\n            ]\r\n        });\r\n        actionSheet.present();\r\n    }\r\n\r\n    private getPictureSuccess(imageBase64) {\r\n        this.isChange = true;\r\n        this.imageBase64 = <string>imageBase64;\r\n        this.userInfo.photo = 'data:image/jpg;base64,' + imageBase64;\r\n    }\r\n\r\n    save() {\r\n        if (this.isChange) {\r\n            let fileObj = <FileObj>{ 'base64': this.imageBase64 };\r\n            this.fileService.uploadByBase64(fileObj).subscribe(result => {// 上传图片到文件服务器\r\n                if (result) {\r\n                    let origPath = FILE_SERVE_URL + result[0].origPath;\r\n                    this.storage.get('UserInfo').then((userInfo: UserInfo) => {\r\n                        userInfo.photo = origPath;\r\n                        this.storage.set('UserInfo', userInfo);\r\n                    });\r\n                    // this.viewCtrl.dismiss({avatarPath: origPath});\r\n                    // 这里需要保存avatar字段到用户表\r\n                }\r\n            });\r\n        } else {\r\n            this.userInfo.photo = this.storage.get('UserInfo')[\"photo\"];\r\n        }\r\n    }\r\n\r\n    signOut(){\r\n        this.storage.clear(); // 清除缓存\r\n        Utils.sessionStorageClear(); // 清除数据缓存\r\n        let modal = this.modalCtrl.create(\"LoginPage\");\r\n        modal.present();\r\n        modal.onDidDismiss(data => {\r\n            data && console.log(data);\r\n        });\r\n    }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/account/account.ts"],"sourceRoot":""}