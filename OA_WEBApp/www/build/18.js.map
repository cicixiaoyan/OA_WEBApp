{"version":3,"sources":["../../src/pages/mail/mail-write/mail-write.module.ts","../../src/pages/mail/mailService.ts","../../src/pages/mail/mail-write/mail-write.ts"],"names":[],"mappings":"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","file":"18.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { MailWrite } from './mail-write';\nimport { MailService } from \"../mailService\";\n@NgModule({\n    declarations: [\n        MailWrite\n    ],\n    imports: [\n        IonicPageModule.forChild(MailWrite),\n    ],\n    exports: [\n        MailWrite\n    ],\n    providers: [MailService]\n})\nexport class MailWriteModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/mail/mail-write/mail-write.module.ts","import { Injectable } from '@angular/core';\nimport { Response } from \"@angular/http\";\nimport 'rxjs/add/operator/map';\nimport { Observable } from 'rxjs/Observable';\nimport { HttpService } from \"../../providers/HttpService\";\n\n@Injectable()\nexport class MailService {\n    mailStatus: object = {\n        inbox: 0, // 收件箱\n        outbox: 1 // 发件箱\n    };\n\n    status: object = {\n        read: 1, // 已读\n        unread: 0, // 未读\n        all: 2 // 全部\n    };\n\n    constructor(public httpService: HttpService) {\n    }\n\n    getInboxList(param?): Observable<any>{\n        console.log(12, param);\n        return this.httpService.postFormData(\"ashx/MailList.ashx\", param).map((res: Response) => res.json());\n    }\n\n    getOutboxList(param?): Observable<any> {\n    return this.httpService.postFormData(\"ashx/MailList.ashx\", param).map((res: Response) => res.json());\n    }\n\n    read(param): Observable<any>{\n        return this.httpService.postFormData(\"ashx/MailGetDetail.ashx\", param).map((res: Response) => res.json());\n    }\n\n    write(param?): Observable<any>{\n        // Uid 当前用户账号id\n        // AcceptUid 接收账号id\n        // Content 发送内容\n        // 返回json\n        // {\"Data\":\"xxx！\",\"Result\":false}\n        return this.httpService.postFormData(\"ashx/MailAdd.ashx\", param).map((res: Response) => res.json());\n    }\n\n    AttachUpload(param): Observable<any>{\n        return this.httpService.postFormData(\"ashx/AttachUpload.ashx\", param).map((res: Response) => res.json());\n    }\n\n    getRecipients(param?): Observable<any>{\n        // 输入参数\n        // Name 输入查询用户名称\n        // 返回json\n        return this.httpService.postFormData(\"ashx/UserSheet.ashx\", param).map((res: Response) => res.json());\n    }\n\n    getRecipientsByDept(id?): Observable<any>{\n        // 输入参数\n        // Name 输入查询用户名称\n        // 返回json\n        return this.httpService.postFormData(\"ashx/UserSheet.ashx\", {DeptId: id}).map((res: Response) => res.json());\n    }\n\n    getDept(): Observable<any> {\n        return this.httpService.postFormData(\"ashx/BmLs.ashx\", {}).map((res: Response) => res.json());\n    }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/mail/mailService.ts","import { Component, ViewChild, ElementRef } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, ViewController,\r\n    AlertController, ActionSheetController, PopoverController } from 'ionic-angular';\r\n\r\nimport { GlobalData } from '../../../providers/GlobalData';\r\nimport { NativeService } from '../../../providers/NativeService';\r\nimport { FileService } from \"../../../providers/FileService\";\r\nimport { FileObj } from \"../../../model/FileObj\";\r\nimport { FILE_SERVE_URL } from \"../../../providers/Constants\";\r\nimport { FileChooser } from '@ionic-native/file-chooser';\r\nimport { FileTransfer, FileUploadOptions, FileTransferObject } from '@ionic-native/file-transfer';\r\nimport { FormBuilder, Validators, FormGroup } from '@angular/forms';\r\nimport { MailService } from \"../mailService\";\r\nimport { Utils } from '../../../providers/Utils';\r\n\r\n\r\n\r\n/**\r\n * Generated class for the MailWrite page.\r\n *\r\n * See http://ionicframework.com/docs/components/#navigation for more info\r\n * on Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage()\r\n@Component({\r\n    selector: 'page-mail-write',\r\n    templateUrl: 'mail-write.html',\r\n})\r\nexport class MailWrite {\r\n    imageBase64: string;\r\n    affixPath: string;\r\n    addressee: string = \"\";\r\n    addresseeIds: string = \"\";\r\n    attName: string = \"\";\r\n    fsbt: \"主题\";\r\n    haveAffix: boolean = false;\r\n\r\n    writeForm: FormGroup;\r\n    @ViewChild(\"popoverContent\", { read: ElementRef }) content: ElementRef;\r\n    constructor(public navCtrl: NavController,\r\n                public navParams: NavParams,\r\n                public actionSheetCtrl: ActionSheetController,\r\n                private popoverCtrl: PopoverController,\r\n                private fileService: FileService,\r\n                public nativeService: NativeService,\r\n                private fileChooser: FileChooser,\r\n                private alertCtrl: AlertController,\r\n                private fileTransfer: FileTransfer,\r\n                private viewCtrl: ViewController,\r\n                private globalData: GlobalData,\r\n                private mailService: MailService,\r\n                private formBuilder: FormBuilder) {\r\n\r\n        this.writeForm = this.formBuilder.group({\r\n            addressee: ['', [Validators.required]],\r\n            Title: ['', []],\r\n            Level: [\"普通\", []],\r\n            Bcc: [false, []],\r\n            Content: [\"\", [Validators.maxLength(180)]],\r\n        });\r\n\r\n        // console.log(this.navParams.get(\"mail\"));\r\n        let mail = this.navParams.get(\"mail\");\r\n        if (typeof (mail) !== \"undefined\") {\r\n            this.affixPath = mail.yjfj;\r\n            this.fsbt = mail.jsbt;\r\n        }\r\n    }\r\n\r\n    ionViewDidLoad() {\r\n        console.log(\"ionViewDidLoad MailWrite\");\r\n    }\r\n\r\n    sent(data) {\r\n        console.log(data);\r\n        let data1 =  {\r\n            \"AccessPresonId\": this.addresseeIds,\r\n            \"AccessPerson\": data.addressee,\r\n            \"Title\": data.Title,\r\n            \"Content\": data.Content,\r\n            \"Level\": data.Level,\r\n            \"Bcc\": data.Bcc,\r\n            \"AttNo\": this.attName,\r\n            \"UserId\": this.globalData.Uid,\r\n            \"UserName\": this.globalData.Name\r\n        };\r\n\r\n        this.mailService.write(data1).subscribe((resJson) => {\r\n            resJson.Result ? this.nativeService.showToast(\"信息已发送\") :\r\n            this.nativeService.showToast(resJson.Data);\r\n        });\r\n\r\n    }\r\n\r\n    addAffix() {\r\n        let options = {\r\n            targetWidth: 400,\r\n            targetHeight: 400\r\n        };\r\n        let actionSheet = this.actionSheetCtrl.create({\r\n            title: '添加附件选择',\r\n            buttons: [\r\n                {\r\n                    text: '相册',\r\n                    handler: () => {\r\n                        this.nativeService.getPictureByPhotoLibrary(options).subscribe(imageBase64 => {\r\n                            this.getPictureSuccess(imageBase64);\r\n                        });\r\n\r\n                    }\r\n                }, {\r\n                    text: '拍照',\r\n                    handler: () => {\r\n                        this.nativeService.getPictureByCamera(options).subscribe(imageBase64 => {\r\n                            this.getPictureSuccess(imageBase64);\r\n                        });\r\n                    }\r\n                }, {\r\n                    text: '文件',\r\n                    handler: () => {\r\n                        this.fileChooser.open().then(fileURL => {\r\n                            let mimeType = fileURL.toLowerCase().split(\".\").splice(-1)[0];\r\n                            let pathOption: FileUploadOptions = {\r\n                                \"fileKey\": \"file\",\r\n                                \"fileName\": fileURL.substr(fileURL.lastIndexOf('/') + 1),\r\n                                \"mimeType\": Utils.getFileMimeType( mimeType ),\r\n                                \"headers\" : {\r\n                                    \"Connection\": \"close\"\r\n                                },\r\n                                \"chunkedMode\": false,\r\n                                \"httpMethod\" : \"POST\",\r\n                                \"params\": {\"token\": this.globalData.token, \"type\": 1}\r\n                            };\r\n                            let url = encodeURI(FILE_SERVE_URL + \"ashx/AttachUpload.ashx\");\r\n                            console.log(fileURL, url, pathOption, true);\r\n                            return this.upload(fileURL, url, pathOption, true);\r\n                        }).catch(err => {\r\n                            console.log(err);\r\n                        });\r\n                    }\r\n                }, {\r\n                    text: '取消',\r\n                    role: 'cancel',\r\n                    handler: () => {\r\n                        console.log('Cancel clicked');\r\n                    }\r\n                }\r\n            ]\r\n        });\r\n        actionSheet.present();\r\n    }\r\n\r\n    checkPeople(myEvent) {\r\n        let popover = this.popoverCtrl.create(\"ContactsPopoverPage\",\r\n            { addressee: this.addressee, addresseeIds: this.addresseeIds });\r\n        popover.present({\r\n            ev: myEvent\r\n        });\r\n        popover.onDidDismiss(data => {\r\n            if (!!data) {\r\n                console.log(data);\r\n                // {addressee:this.addressee,addresseeIds:this.addresseeIds}\r\n                this.addresseeIds = data.addresseeIds;                \r\n                this.writeForm.patchValue({'addressee': data.addressee});\r\n            }\r\n\r\n        });\r\n    }\r\n\r\n    private getPictureSuccess(imageBase64) {\r\n        this.imageBase64 = <string>imageBase64;\r\n        this.affixPath = \"data:image/jpg;base64,\" + imageBase64;\r\n        let fileObj = <FileObj>{ \"base64\": this.imageBase64 };\r\n        this.fileService.uploadByBase64(fileObj).subscribe(result => {// 上传图片到文件服务器\r\n            if (result) {\r\n                let origPath = FILE_SERVE_URL + result.origPath;\r\n                console.log(origPath);\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * 上传\r\n     */\r\n    upload(fileUrl, url, options, trustAllHosts?: boolean) {\r\n        let alert = this.alertCtrl.create({\r\n            title: '上传进度：0%',\r\n            enableBackdropDismiss: false,\r\n            buttons: ['后台上传']\r\n        });\r\n        alert.present();\r\n\r\n        const fileTransfer: FileTransferObject = this.fileTransfer.create();\r\n\r\n        fileTransfer.onProgress((event: ProgressEvent) => {\r\n            let num = Math.floor(event.loaded / event.total * 100);\r\n            if (num === 100) {\r\n                alert.dismiss();\r\n            } else {\r\n                let title = document.getElementsByClassName('alert-title')[0];\r\n                title && (title.innerHTML = '上传进度：' + url + event.loaded + \" \" + event.total + '%');\r\n            }\r\n        });\r\n        return fileTransfer.upload(fileUrl, url, options, trustAllHosts).then((data) => {\r\n            console.log(data);\r\n            this.haveAffix = true;\r\n\r\n          }, (err) => {\r\n            // error\r\n            console.log(err);\r\n          }).catch((err) => {\r\n            console.log(err);\r\n            alert.dismiss();\r\n            this.nativeService.showToast(err);\r\n          });\r\n    }\r\n\r\n    dismiss() {\r\n        this.viewCtrl.dismiss();\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/mail/mail-write/mail-write.ts"],"sourceRoot":""}